<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>MesaChef ¬∑ Salones</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#475569',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #f8fafc;
            font-family: 'Segoe UI', sans-serif;
        }

        .modal-content {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        input,
        select,
        textarea {
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            padding: 0.5rem;
            width: 100%;
            outline: none;
        }

        input:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 2px #bfdbfe;
            outline: none;
        }

        label {
            font-size: 0.75rem;
            font-weight: 700;
            color: #64748b;
            text-transform: uppercase;
            margin-bottom: 0.25rem;
            display: block;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800">

    <!-- NAV -->
    <nav class="bg-white shadow-sm sticky top-0 z-30 border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">

                <!-- LEFT: LOGO & STATUS & HOTEL -->
                <div class="flex items-center gap-6">
                    <!-- MesaChef Logo -->
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">üë®‚Äçüç≥</span>
                        <div class="flex flex-col leading-none">
                            <span class="text-primary font-bold text-lg tracking-tight">MesaChef</span>
                            <span
                                class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Enterprise</span>
                        </div>
                    </div>

                    <!-- Vertical Divider -->
                    <div class="h-8 w-px bg-slate-200"></div>

                    <!-- Connection Status -->
                    <div class="flex items-center gap-2 px-3 py-1 bg-green-50 rounded-full border border-green-100"
                        id="connStatus">
                        <div
                            class="w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]">
                        </div>
                        <span class="text-xs font-bold text-green-700 uppercase tracking-wide">Online</span>
                    </div>

                    <!-- Hotel Identity (Static) -->
                    <div class="flex items-center gap-2">
                        <span class="text-xl">üè®</span>
                        <span id="headerHotelName" class="font-bold text-slate-700 text-lg">Cargando...</span>
                    </div>
                </div>

                <!-- RIGHT: EXIT & NEW EVENT -->
                <div class="flex items-center gap-4">
                    <!-- Exit Button -->
                    <a href="index.html"
                        class="flex items-center gap-2 text-slate-400 hover:text-red-500 font-bold text-sm transition group">
                        <span class="group-hover:-translate-x-1 transition-transform">‚¨Ö</span>
                        Volver al Inicio
                    </a>

                    <div class="h-6 w-px bg-slate-200"></div>

                    <!-- Add Event Button -->
                    <button onclick="openBooking()"
                        class="bg-primary hover:bg-blue-700 text-white px-5 py-2 rounded-lg font-bold shadow-lg shadow-blue-500/30 transition flex items-center gap-2 transform hover:scale-105 active:scale-95">
                        <span class="text-xl leading-none">+</span>
                        <span>Nuevo Evento</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- CONTENT -->
    <div class="w-full px-4 lg:px-6 py-6" id="app">

        <!-- Toolbar -->
        <div
            class="flex flex-col xl:flex-row items-center justify-between gap-4 mb-4 bg-white p-1 rounded-2xl shadow-sm border border-slate-100">

            <!-- LEFT: Print Buttons -->
            <div class="flex items-center gap-4 w-full xl:w-auto justify-center xl:justify-start">
                <div class="flex gap-2">
                    <button onclick="printReport('semana')"
                        class="flex items-center gap-2 h-8 px-3 bg-white border border-slate-200 text-slate-600 hover:text-slate-800 hover:border-slate-300 rounded-xl text-xs font-bold transition hover:shadow-sm"
                        title="Imprimir Semana">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-400" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <polyline points="6 9 6 2 18 2 18 9" />
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
                            <rect x="6" y="14" width="12" height="8" />
                        </svg>
                        <span class="hidden sm:inline">Semana</span>
                    </button>
                    <button onclick="printReport('dia')"
                        class="flex items-center gap-2 h-8 px-3 bg-white border border-slate-200 text-slate-600 hover:text-slate-800 hover:border-slate-300 rounded-xl text-xs font-bold transition hover:shadow-sm"
                        title="Imprimir Diario">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-400" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14 2 14 8 20 8" />
                            <line x1="16" y1="13" x2="8" y2="13" />
                            <line x1="16" y1="17" x2="8" y2="17" />
                            <polyline points="10 9 9 9 8 9" />
                        </svg>
                        <span class="hidden sm:inline">Diario</span>
                    </button>
                </div>
            </div>

            <!-- CENTER: Date Control (Split) -->
            <div
                class="flex flex-1 flex-row items-center justify-center gap-3 order-first xl:order-none w-full xl:w-auto">
                <button onclick="changeWeek(-1)"
                    class="w-8 h-8 flex items-center justify-center bg-white border border-slate-200 rounded-lg text-slate-500 hover:text-blue-600 hover:border-blue-300 hover:shadow-sm transition"
                    title="Semana Anterior">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m15 18-6-6 6-6" />
                    </svg>
                </button>

                <div class="relative group">
                    <input type="date" id="datePicker" onchange="goToDate(this.value)"
                        class="h-9 pl-3 pr-10 bg-white border border-slate-200 rounded-lg text-sm font-bold text-slate-700 focus:ring-2 focus:ring-blue-500/10 focus:border-blue-500 outline-none w-40 text-center shadow-sm cursor-pointer appearance-none hover:border-blue-300 transition uppercase tracking-wide">
                    <div
                        class="absolute inset-y-0 right-3 flex items-center pointer-events-none text-slate-400 group-hover:text-blue-500 transition">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                            <line x1="16" y1="2" x2="16" y2="6" />
                            <line x1="8" y1="2" x2="8" y2="6" />
                            <line x1="3" y1="10" x2="21" y2="10" />
                            <path d="M8 14h.01" />
                            <path d="M12 14h.01" />
                            <path d="M16 14h.01" />
                            <path d="M8 18h.01" />
                            <path d="M12 18h.01" />
                            <path d="M16 18h.01" />
                        </svg>
                    </div>
                </div>

                <div class="h-6 w-px bg-slate-200 mx-2 hidden sm:block"></div>

                <button onclick="changeWeek(1)"
                    class="w-8 h-8 flex items-center justify-center bg-white border border-slate-200 rounded-lg text-slate-500 hover:text-blue-600 hover:border-blue-300 hover:shadow-sm transition"
                    title="Semana Siguiente">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m9 18 6-6-6-6" />
                    </svg>
                </button>
            </div>

            <!-- RIGHT: Filters + Search -->
            <div class="flex items-center gap-3 w-full xl:w-auto justify-center xl:justify-end">
                <!-- Status Filter -->
                <div class="relative">
                    <select id="filterStatus" onchange="renderGrid()"
                        class="appearance-none h-8 pl-3 pr-8 bg-slate-50 border border-slate-200 rounded-xl text-xs font-bold text-slate-600 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none cursor-pointer hover:bg-white transition shadow-sm w-36">
                        <option value="activos">Activos (Conf + Prov)</option>
                        <option value="todos">Todos los estados</option>
                        <option value="confirmada">üü¢ Confirmados</option>
                        <option value="provisional">üü° Provisionales</option>
                        <option value="presupuesto">üü† Presupuestos</option>
                        <option value="cancelada">üî¥ Cancelados</option>
                    </select>
                    <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none text-slate-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m6 9 6 6 6-6" />
                        </svg>
                    </div>
                </div>

                <!-- Search Input -->
                <div class="relative">
                    <input type="text" id="searchInput" onkeyup="handleSearch(this.value)" placeholder="Buscar..."
                        class="h-8 pl-9 pr-3 w-40 xl:w-48 bg-slate-50 border border-slate-200 rounded-xl text-xs font-bold text-slate-600 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition shadow-sm placeholder-slate-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 absolute left-3 top-2 text-slate-400"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <!-- Search Results Dropdown -->
                    <div id="searchResults"
                        class="hidden absolute top-full right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-slate-100 max-h-96 overflow-y-auto z-50 divide-y divide-slate-50">
                    </div>
                </div>

                <!-- Print Area -->
                <div id="printArea" class="hidden print:block fixed inset-0 bg-white z-[9999] p-8"></div>

            </div>
        </div>

        <!-- Main Grid Container -->
        <div id="calendarGrid" class="flex-1 overflow-auto">
            <div class="flex flex-col items-center justify-center p-10 h-64 text-slate-400">
                <span class="text-4xl mb-4 animate-bounce">‚è≥</span>
                <span class="font-bold text-lg">Cargando aplicaci√≥n...</span>
            </div>
        </div>
        <div id="modal-evt" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog"
            aria-modal="true">
            <div class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"></div>
            <div class="fixed inset-0 z-10 overflow-y-auto">
                <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                    <div
                        class="relative transform overflow-hidden rounded-xl bg-white text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-5xl modal-content">

                        <div class="bg-white px-4 py-2 border-b flex justify-between items-center bg-gray-50">
                            <h3 class="text-lg font-bold text-slate-800">Evento</h3>
                            <button onclick="closeModal()"
                                class="text-slate-400 hover:text-slate-600 font-bold text-xl">&times;</button>
                        </div>

                        <div class="px-4 py-3 space-y-3 bg-white">

                            <!-- ROW 1: LOGISTICS (Fecha, Hora, Sal√≥n, Estado) -->
                            <div class="grid grid-cols-12 gap-3">
                                <div class="col-span-2">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Fecha</label>
                                    <input type="date" id="evt-fecha"
                                        class="w-full text-sm font-bold bg-gray-50 border-gray-200 rounded h-9">
                                </div>
                                <div class="col-span-2">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Hora</label>
                                    <input type="time" id="evt-hora" class="w-full text-xs border-gray-200 rounded h-9">
                                </div>
                                <div class="col-span-5">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Sal√≥n</label>
                                    <select id="evt-salon" onchange="updateRentalPrice()"
                                        class="w-full text-sm font-bold bg-gray-50 border-gray-200 rounded h-9">
                                    </select>
                                </div>
                                <div class="col-span-3">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Estado</label>
                                    <select id="evt-estado"
                                        class="w-full text-xs font-bold border-gray-200 rounded h-9">
                                        <option value="presupuesto">üü† Presupuesto</option>
                                        <option value="provisional">üü° Provisional</option>
                                        <option value="confirmada" selected>üü¢ Confirmada</option>
                                        <option value="cancelada">üî¥ Cancelada</option>
                                    </select>
                                </div>
                            </div>

                            <!-- ROW 2: CLIENT (Nombre, Tel, Email) -->
                            <div
                                class="grid grid-cols-12 gap-3 bg-blue-50/50 p-2 rounded -mx-2 border border-blue-50/50">
                                <div class="col-span-6">
                                    <label class="text-[10px] uppercase font-bold text-blue-400">Cliente /
                                        Evento</label>
                                    <input type="text" id="evt-nombre" placeholder="Nombre del cliente o evento..."
                                        class="w-full text-sm font-bold border-gray-200 rounded h-9">
                                </div>
                                <div class="col-span-3">
                                    <label class="text-[10px] uppercase font-bold text-blue-400">Tel√©fono</label>
                                    <input type="tel" id="evt-telefono" placeholder="Tel..."
                                        class="w-full text-xs border-gray-200 rounded h-9">
                                </div>
                                <div class="col-span-3">
                                    <label class="text-[10px] uppercase font-bold text-blue-400">Email</label>
                                    <input type="email" id="evt-email" placeholder="@"
                                        class="w-full text-xs border-gray-200 rounded h-9">
                                </div>
                            </div>

                            <!-- ROW 3: OPERATIONS (Jornada, Montaje, Pax) -->
                            <div class="grid grid-cols-12 gap-3">
                                <div class="col-span-3">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Jornada</label>
                                    <select id="evt-jornada" onchange="updateRentalPrice()"
                                        class="w-full text-xs border-gray-200 rounded h-9">
                                        <option value="todo">Todo el d√≠a</option>
                                        <option value="ma√±ana">Ma√±ana</option>
                                        <option value="tarde">Tarde</option>
                                    </select>
                                </div>
                                <div class="col-span-5">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Montaje</label>
                                    <select id="evt-montaje"
                                        class="w-full text-xs border-gray-200 rounded h-9"></select>
                                </div>
                                <div class="col-span-2">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Pax Adultos</label>
                                    <input type="number" id="evt-pax-a" placeholder="0"
                                        class="w-full text-xs border-gray-200 rounded h-9 text-center">
                                </div>
                                <div class="col-span-2">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Pax Ni√±os</label>
                                    <input type="number" id="evt-pax-n" placeholder="0"
                                        class="w-full text-xs border-gray-200 rounded h-9 text-center">
                                </div>
                            </div>

                            <hr class="border-gray-100 my-1">

                            <!-- SERVICES -->
                            <div>
                                <div class="flex justify-between items-center mb-1">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Servicios</label>
                                    <div class="text-right font-bold text-sm">Total: <span id="evt-total"
                                            class="text-blue-600">0.00 ‚Ç¨</span></div>
                                </div>
                                <div class="bg-gray-50 border rounded shadow-inner max-h-40 overflow-y-auto">
                                    <table class="w-full text-xs">
                                        <thead class="bg-gray-100 sticky top-0">
                                            <tr>
                                                <th class="p-1 w-24">Fecha</th>
                                                <th class="p-1 text-left">Concepto</th>
                                                <th class="p-1 w-12 text-center">Uds</th>
                                                <th class="p-1 w-16 text-right">Pre</th>
                                                <th class="p-1 w-16 text-right">Tot</th>
                                                <th class="p-1 w-6"></th>
                                            </tr>
                                        </thead>
                                        <tbody id="services-list" class="divide-y divide-gray-200"></tbody>
                                    </table>
                                </div>
                                <div class="flex justify-between mt-1">
                                    <button onclick="addServiceRow()"
                                        class="text-blue-600 font-bold text-xs hover:underline">+ A√±adir Item</button>
                                    <button
                                        class="bg-purple-100 text-purple-700 text-[10px] px-2 py-0.5 rounded font-bold hover:bg-purple-200">‚ú®
                                        AI Menu</button>
                                </div>
                            </div>

                            <!-- NOTES & CHECK -->
                            <div class="grid grid-cols-12 gap-3 mt-2">
                                <div class="col-span-12">
                                    <div class="flex items-center space-x-2 mb-1 pl-1">
                                        <input type="checkbox" id="evt-revisado"
                                            class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                        <label for="evt-revisado"
                                            class="text-xs font-bold text-slate-700 select-none cursor-pointer">Evento
                                            Revisado</label>
                                    </div>
                                </div>
                                <div class="col-span-6">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Nota Interna</label>
                                    <textarea id="evt-nota-interna" rows="1"
                                        class="w-full text-xs border-gray-200 rounded resize-none focus:h-16 transition-all"
                                        placeholder="S√≥lo visible para nosotros..."></textarea>
                                </div>
                                <div class="col-span-6">
                                    <label class="text-[10px] uppercase font-bold text-gray-500">Nota Cliente</label>
                                    <textarea id="evt-nota-cliente" rows="1"
                                        class="w-full text-xs border-gray-200 rounded resize-none focus:h-16 transition-all"
                                        placeholder="Visible para cliente..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-50 px-4 py-2 flex justify-between items-center border-t">
                            <button class="text-red-400 hover:text-red-600 text-xs font-bold"
                                onclick="if(confirm('¬øEliminar?')) alert('Funci√≥n pendiente')">üóëÔ∏è Eliminar</button>
                            <div class="flex gap-2">
                                <button
                                    class="bg-white text-gray-700 font-bold py-1 px-3 border rounded text-xs hover:bg-gray-50"
                                    onclick="closeModal()">Cancelar</button>
                                <button
                                    class="bg-slate-800 text-white font-bold py-1 px-4 rounded text-xs hover:bg-black shadow"
                                    onclick="saveBooking()">GUARDAR</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Datalist for Concepts -->
        <datalist id="charge-options"></datalist>

        <script src="js/salones.js"></script>
</body>

</html>